// adt.js 
// ------
// Algebraic data types and immutable structures in Javascript
//
// version : 0.6.1
// author  : Nathan Faubion <nathan@n-son.com>
// license : MIT
(function(e){"use strict";e.util={},e.util.toArray=function(e,t){var n=[],r=t||0,i=e.length;for(;r<i;r++)n.push(e[r]);return n},e.util.ctrApply=function(e,t){var n=function(){};n.prototype=e.prototype;var r=new n,i=e.apply(r,t);return Object(i)===i?i:r},e.util.partial=function(t){var n=e.util.toArray(arguments,1);return function(){return t.apply(this,n.concat(e.util.toArray(arguments)))}},e.util.inherit=function(e,t){var n=function(){};return n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t},e.util.uniqueId=function(e){return function(t){return(t||"")+e++}}(0),e.util.typeCheck=function(t,n){var r=0,i=t.length,s;for(;r<i;r++){s=t[r];if(s instanceof Function){if(n instanceof s||s===Number&&typeof n=="number"||s===String&&typeof n=="string"||s===Boolean&&typeof n=="boolean")return!0}else if(s instanceof e.__Base__&&s.equals(n)||s===n)return!0}return!1},e.util.toJSONValue=function(e){return e&&typeof e=="object"&&e.toJSON?e.toJSON():e},e.__Base__=function(){},e.data=function(){var t=typeof arguments[0],n,r,i;if(t==="string"){var s=arguments;return e.data(function(e){var t=0,n=s.length;for(;t<n;t++)e(s[t])})}if(t==="object")return r=arguments[0],e.data(function(e){for(var t in r)r.hasOwnProperty(t)&&e(t,r[t])});n=arguments[0]||function(){},i=[];var o=e.util.inherit(e.__Base__,function(){if(!(this instanceof o)&&o.apply!==Function.prototype.apply)return o.apply(this,arguments)});o.type=function(t,n){typeof t!="string"&&(n=t,t=e.util.uniqueId("Anonymous"));var r=e.util.typeCheck([String,Boolean,Number,null,void 0],n);return r?n=e.single(n):typeof n!="function"&&(n=e.record(n)),o.prototype["is"+t]=!1,o[t]=n(o,t),i.push(t),o[t]};var r=n.call(o,o.type,o);if(typeof r=="object"&&!(r instanceof e.__Base__))for(var u in r)r.hasOwnProperty(u)&&o.type(u,r[u]);return o.seal=function(){var e=0,t,n,r;for(;t=i[e];e++)n=this[t].seal,n instanceof Function&&n();return delete o.type,delete o.seal,o},o.__names__=i,o},e.single=function(t){typeof t=="undefined"&&(t=null);var n=function(){};return function(r,i){return e.util.inherit(r,n),n.className=i,n.prototype.clone=function(){return this},n.prototype.equals=function(e){return this===e},n.prototype.toString=function(){return i},n.prototype.toJSON=function(){return t},n.prototype["is"+i]=!0,new n}},e.record=function(){var t=typeof arguments[0],n,r,i,s,o;if(t==="string"){var u=arguments;return e.record(function(t){var n=0,r=u.length;for(;n<r;n++)t(u[n],e.any)})}return t==="object"?(s=arguments[0],e.record(function(e){for(var t in s)s.hasOwnProperty(t)&&e(t,s[t])})):(o=arguments[0]||function(){},n=[],r={},i=function(){var t=e.util.toArray(arguments),s=n.length;if(!(this instanceof i))return t.length<s?e.util.partial.apply(null,[i].concat(t)):e.util.ctrApply(i,t);if(t.length<s)throw new Error("Too few arguments");if(t.length>s)throw new Error("Too many arguments");var o=0,u;for(;u=n[o];o++)this[u]=r[u](t[o])},function(t,u){e.util.inherit(t,i),i.className=u,i.prototype["is"+u]=!0,i.prototype.toString=function(){var e=i.unapply(this);return u+(e.length?"("+e.join(", ")+")":"")},i.prototype.clone=function(){var t=[],r=0,s,o;for(;s=n[r];r++)o=this[s],t[r]=o instanceof e.__Base__?o.clone():e.nativeClone(o);return i.apply(null,t)},i.prototype.get=function(e){if(typeof e=="number"){if(e<0||e>n.length-1)throw new Error("Field index out of range: "+e);e=n[e]}else if(!r.hasOwnProperty(e))throw new Error("Field name does not exist: "+e);return this[e]},i.prototype.set=function(e){var t=[],r=0,s;for(;s=n[r];r++)t[r]=s in e?e[s]:this[s];return i.apply(null,t)},i.prototype.equals=function(t){if(this===t)return!0;if(t instanceof i){var r=0,s=n.length,o,u,a;for(;r<s;r++){a=n[r],o=this[a],u=t[a];if(o instanceof e.__Base__){if(!o.equals(u))return!1}else if(!e.nativeEquals(o,u))return!1}return!0}return!1},i.create=function(e){var t=[],r=0,s=n.length,o;for(;r<s;r++){o=n[r];if(!(o in e))throw new Error("Could not find field in arguments: "+o);t[r]=e[o]}return i.apply(null,t)},i.unapply=function(e){var t=[],r=0,i;for(;i=n[r];r++)t[r]=e[i];return t},i.unapplyObj=function(e,t){var r={},i=0,s;for(;s=n[i];i++)r[s]=t?t(e[s],s):e[s];return r},i.prototype.toJSON=function(){return i.unapplyObj(this,e.util.toJSONValue)},i.field=function(t,s){s||(s=e.any);if(typeof s!="function")throw new TypeError("Constraints must be functions");return n.push(t),r[t]=s,i},s=o.call(i,i.field,i);if(typeof s=="object"&&s!==i)for(var u in s){if(!s.hasOwnProperty(u))continue;i.field(u,s[u])}return i.__names__=n,i.__constraints__=r,i.seal=function(){return delete i.field,delete i.seal,i},i})},e.enumeration=function(){function r(e){return e.constructor&&(e=e.constructor),e.__order__=n++,e}function i(e){if(e instanceof t)return!0;throw new TypeError("Unexpected type")}function s(e){return e.constructor.__order__}var t=e.data.apply(null,arguments),n=0,o=0,u;for(;u=t.__names__[o];o++)r(t[u]);var a=t.type;return t.type=function(e,n){return r(a.call(t,e,n))},t.prototype.lt=function(e){return i(e)&&s(this)<s(e)},t.prototype.lte=function(e){return i(e)&&s(this)<=s(e)},t.prototype.gt=function(e){return i(e)&&s(this)>s(e)},t.prototype.gte=function(e){return i(e)&&s(this)>=s(e)},t.prototype.eq=function(e){return i(e)&&s(this)===s(e)},t.prototype.neq=function(e){return i(e)&&s(this)!==s(e)},t},e["enum"]=e.enumeration,e.newtype=function(){var t=e.util.toArray(arguments),n=e.data();return n.type.apply(n,t)},e.any=function(e){return e},e.only=function(){var t=arguments;return function(n){if(e.util.typeCheck(t,n))return n;throw new TypeError("Unexpected type")}},e.nativeClone=function(e){return e},e.nativeEquals=function(e,t){return e===t}})(typeof exports!="undefined"?exports:this.adt={});